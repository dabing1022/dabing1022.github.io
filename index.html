<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="HappyCoding:)" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/uploads/avatar.png?v=5.0.1" />






<meta name="description" content="思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。">
<meta property="og:type" content="website">
<meta property="og:title" content="HappyCoding:)">
<meta property="og:url" content="dabing1022.github.io/index.html">
<meta property="og:site_name" content="HappyCoding:)">
<meta property="og:description" content="思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HappyCoding:)">
<meta name="twitter:description" content="思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: "post",
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="dabing1022.github.io/"/>

  <title> HappyCoding:) </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  

  <div class="container one-collumn  
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">HappyCoding:)</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/04/了解认识DNS/" itemprop="url">
                  一起学习 DNS
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-02-04T15:36:00+08:00" content="Feb 4 2017">
              Feb 4 2017
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/02/04/了解认识DNS/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/04/了解认识DNS/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一起学习 DNS</p>
<h1 id="什么是_DNS_？">什么是 DNS ？</h1><blockquote>
<p>网域名称系统（英文：Domain Name System，缩写：DNS）是互联网的一项服务。它作为将域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。DNS使用TCP和UDP端口53。当前，对于每一级域名长度的限制是63个字符，域名总长度则不能超过253个字符。</p>
</blockquote>
<p>一方面，DNS能够帮助我们省去记忆和输入 IP 地址的麻烦。另一方面，对于在不同ip的主机开发部署有着很重要的意义：如果我们在访问一个ip地址为115.159.231.171的一个Web主页，假设如果公司将这个Web主页移动到了另外一个不同的ip主机上，那是不是要通知到每一个使用原ip地址访问服务的用户？这显然行不通。所以域名到网络ip地址的映射具有非常重要的意义。</p>
<p>从域名到IP地址的一个翻译过程，我们俗称“DNS解析”。在DNS解析之后，便拿到了ip地址，有了ip地址，应用程序便可以与目标主机建立一个TCP连接或者发送UDP数据包。</p>
<h1 id="DNS_解析">DNS 解析</h1><p>我们以查找<code>www.zhuanzhuan.com</code>为例子：</p>
<p>0.查询Local DNS服务器</p>
<p>我们不得不提到这个Local DNS 服务器。Local DNS包括网络服务提供商（ISP）分配给我们的DNS（一般为两个），或者是其他组织提供的公共DNS，比如谷歌的8.8.8.8，国内114DNS的114.114.114.114。因为这些DNS的地址填写在我们的本地电脑或者移动设备上，所以也称为Local DNS。有时候我们看到电脑或者移动设备上，DNS的地址是路由器的地址，而路由器本身会将DNS请求转发到ISP的DNS服务器上。这个小细节需要注意下。</p>
<p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/DNS.001.png" alt=""></p>
<p>1.查询DNS根服务器</p>
<p>DNS根服务器是一个超级大管家，掌管着所有顶级域名服务器，比如商用的<code>.com</code>，非赢利组织使用的<code>.org</code>，教育机构使用的<code>.edu</code>，政府部门使用的<code>.gov</code>等等，世界上的顶级域名大概有250多个。我们例子的顶级域名是<code>.com</code>，于是DNS根服务器会将查询请求转发给<code>.com</code>顶级域名服务器。</p>
<p>2.查询<code>.com</code>顶级域名服务器</p>
<p>.com顶级域名服务器掌管着<code>.com</code>域，我们的目标是<code>zhuanzhuan.com</code>，于是下一步将请求转发给<code>zhuanzhuan.com</code>域名服务器</p>
<p>3.查询zhuanzhuan.com域名服务器</p>
<p>zhuanzhuan.com域名服务器掌管着zhuanzhuan.com域下所有的子域和主机。它当然知道<code>www.zhuanzhuan.com</code>的IP地址。</p>
<p>4.访问www.zhuanzhuan.com对应的web服务器</p>
<p>根据上一步返回的IP地址进行访问。这里例子中，我们描绘的场景是一个最坏的情况，发生在DNS服务器没有缓存任何有用信息时。而在实际情况中，由于DNS服务器的缓存机制，在进行DNS解析道时候，实际的查询路径可能会更短，甚至没有，直接从本地DNS服务器缓存命中返回。</p>
<p>DNS的查询和响应使用的传输层协议是UDP协议。DNS消息通过UDP数据包发送，如果在一个限定时间内没有收到响应的UDP数据包，那么DNS客户端则会重复查询请求，如果重复一定次数仍然失败，则会尝试域内另一台DNS服务器。</p>
<h1 id="DNS_查询：递归／迭代">DNS 查询：递归／迭代</h1><p>递归查询:服务器必需回答域名与目标IP的映射关系，对这个关系的描述必须是完整的。<br>迭代查询:服务器收到一次迭代查询回复一次结果，这个结果不一定是目标IP与域名的映射关系，也可以是其它DNS服务器的地址。</p>
<p>如文中图所示从客户端到本地DNS服务器是属于递归查询，而DNS服务器之间就是的交互查询就是迭代查询。一次域名解析可以涉及到递归和迭代两种机制。</p>
<h1 id="DNS劫持">DNS劫持</h1><p>DNS劫持都谁干的好事？运营商。中国的电信运营商包括了三大运营商中国电信、中国移动、中国联通，还有一些小的运营商，包括长城宽带、歌华有线宽带等。我们可以谷歌搜索下，关于DNS劫持的问题，很多人都曾经遇到过。DNS劫持是网络运营商作恶的方式之一。电信运营商将原本网Web的IP地址故意解析为包含广告的IP地址，这样用户在访问网站时就会看到电信运营商那些无耻的广告。</p>
<p>之前转转的用户就遇到过这样的问题。我们发现用户所在的地方，优品服务的一个域名被电信运营商给劫持了，跳转到了联通移动网络域名纠错导航页面。当用户使用WIFI时，我们可以修改网络的高级设置中DNS，尝试修改为谷歌的8.8.8.8，114DNS的114.114.114.114, 或者阿里DNS 223.5.5.5, 223.6.6.6等来解决。</p>
<p>HTTPS解决的是HTTP劫持，并不能解决DNS劫持问题。更多阅读可以阅读文末的推荐文章<a href="http://bigsec.com/bigsec-news/wechat-16824-yunyingshangjiechi" target="_blank" rel="external">运营商的勾当：DNS劫持和HTTP劫持有什么区别</a>。</p>
<h1 id="iOS清除DNS_CACHE">iOS清除DNS CACHE</h1><p>iOS设备对域名访问时并不是每次访问都需要向DNS服务器发出请求，一般来说当解析工作完成一次后，该解析结果会保存在设备的DNS缓存列表中，如果这时DNS解析出现更改变动的话，由于DNS缓存列表信息没有改变，所以仍旧会按照之前缓存的结果来解析，便会出现DNS解析故障。这时候我们要清除本地的DNS缓存，一般有几个办法：</p>
<ol>
<li>开启飞行模式 -&gt; 修改DNS -&gt; 关闭飞行模式</li>
<li>开关机</li>
<li>重置网络设置</li>
</ol>
<h1 id="修改HOST是什么鬼？">修改HOST是什么鬼？</h1><p>不知道读者有没有修改过电脑host文件的经历，我们修改有时候只是为了屏蔽不想访问的网站让破解软件注册时不向自己的服务器发送信息，比如发送到127.0.0.1本机地址上，有时候是为了测试，让线上的域名映射到开发环境的ip，有时候为了加速网站的解析速速。修改HOST给了我们很多方便的可能。</p>
<p>iOS非越狱设备我们是无法修改HOST文件的，越狱之后，就另当别论了。</p>
<h1 id="域名解析到常用命令">域名解析到常用命令</h1><p>域名解析中常用的命令有三个：dig、nslookup、host，关于这三个命令的一些使用，读者可以移步到阮一峰的<a href="http://www.ruanyifeng.com/blog/2016/06/dns.html" target="_blank" rel="external">DNS原理入门</a>。</p>
<h1 id="更多参考">更多参考</h1><ul>
<li><a href="http://bigsec.com/bigsec-news/wechat-16824-yunyingshangjiechi" target="_blank" rel="external">运营商的勾当：DNS劫持和HTTP劫持有什么区别</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/06/dns.html" target="_blank" rel="external">阮一峰：DNS原理入门</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/24/聊一聊HTTP的Range, Content-Range/" itemprop="url">
                  聊一聊HTTP的Range, Content-Range
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-12-24T10:00:00+08:00" content="Dec 24 2016">
              Dec 24 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ios/" itemprop="url" rel="index">
                    <span itemprop="name">ios</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/12/24/聊一聊HTTP的Range, Content-Range/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/24/聊一聊HTTP的Range, Content-Range/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/xmas1.jpeg" alt=""><br><img src="http://7u2lyz.com1.z0.glb.clouddn.com/xmas2.jpeg" alt=""><br><img src="http://7u2lyz.com1.z0.glb.clouddn.com/xmas3.jpeg" alt=""></p>
<h2 id="前言">前言</h2><p>早上8点左右的时候看到了微信群里有一条分享，点开进去后是一个视频，是网易新闻的一个关于圣诞节的一个推广视频，刚好就坐在电脑旁边，便用 Charles 抓包看了下。</p>
<p>因为以前对视频加载这块接触的不多，便想了解下获取视频的请求和普通的请求有什么不通，如何播放就不谈了，主要从HTTP协议的角度研究学习下。</p>
<p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/charles-00.png" alt=""><br><img src="http://7u2lyz.com1.z0.glb.clouddn.com/charles-01.png" alt=""><br><img src="http://7u2lyz.com1.z0.glb.clouddn.com/charles-02.png" alt=""></p>
<p>刚打开网页的时候只有前3个请求，此时视频是暂停的，通过视频上方中的播放按钮开始了播放，这时候开始发出了第4个请求。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">HTTP-Trace-Version: <span class="number">1.0</span>  // Charles的http trace版本</span><br><span class="line">Generator: Charles/<span class="number">4.0</span>.<span class="number">1</span> // Charles版本</span><br><span class="line"></span><br><span class="line">// 请求</span><br><span class="line">Method: GET</span><br><span class="line">Protocol-Version: HTTP/<span class="number">1.1</span></span><br><span class="line">Protocol: http</span><br><span class="line">Host: file.ws.<span class="number">126</span>.net</span><br><span class="line">File: /<span class="number">3</span>g/activities/xmas2016.mp4</span><br><span class="line">Remote-Address: <span class="number">58.59</span>.<span class="number">19.125</span></span><br><span class="line">Client-Address: <span class="number">192.168</span>.<span class="number">1.104</span></span><br><span class="line">Start-Time: <span class="number">2016</span>-<span class="number">12</span>-<span class="number">24</span>T08:<span class="number">20</span>:<span class="number">44.528</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">DNS-Duration: <span class="number">9</span></span><br><span class="line">Connect-Duration: <span class="number">22</span></span><br><span class="line">Request-Begin-Time: <span class="number">2016</span>-<span class="number">12</span>-<span class="number">24</span>T08:<span class="number">20</span>:<span class="number">44.560</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">Request-Time: <span class="number">2016</span>-<span class="number">12</span>-<span class="number">24</span>T08:<span class="number">20</span>:<span class="number">44.561</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">Response-Time: <span class="number">2016</span>-<span class="number">12</span>-<span class="number">24</span>T08:<span class="number">20</span>:<span class="number">44.586</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">End-Time: <span class="number">2016</span>-<span class="number">12</span>-<span class="number">24</span>T08:<span class="number">20</span>:<span class="number">44.588</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">Request-Header-Size: <span class="number">504</span></span><br><span class="line">Response-Header-Size: <span class="number">424</span></span><br><span class="line">Request-Body-Size: <span class="number">0</span></span><br><span class="line">Response-Body-Size: <span class="number">2</span></span><br><span class="line">Request-Body-Decoded: <span class="literal">false</span></span><br><span class="line">Response-Body-Decoded: <span class="literal">false</span></span><br><span class="line">Request-Header:&lt;&lt;--EOF-<span class="number">1482539973400</span>-</span><br><span class="line">GET /<span class="number">3</span>g/activities/xmas2016.mp4 HTTP/<span class="number">1.1</span></span><br><span class="line">Host: file.ws.<span class="number">126</span>.net</span><br><span class="line">Accept-Language: zh-cn</span><br><span class="line">X-Playback-Session-Id: <span class="number">843</span>D959A-<span class="number">32</span>AD-<span class="number">49</span>C4-A2D7-<span class="number">32065</span>A6292D9</span><br><span class="line">Range: bytes=<span class="number">0</span>-<span class="number">1</span></span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (iPhone; CPU iPhone OS <span class="number">10</span>_2 like Mac OS X) AppleWebKit/<span class="number">602.3</span>.<span class="number">12</span> (KHTML, like Gecko) Mobile/<span class="number">14</span>C92 MicroMessenger/<span class="number">6.5</span>.<span class="number">2</span> NetType/WIFI Language/zh_CN</span><br><span class="line">Referer: http://c.m.<span class="number">163</span>.com/nc/qa/activity/<span class="number">20161202</span>/index.html?from=groupmessage&amp;isappinstalled=<span class="number">1</span></span><br><span class="line">Accept-Encoding: identity</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--EOF-<span class="number">1482539973400</span>-</span><br><span class="line">// 响应</span><br><span class="line">Response-Header:&lt;&lt;--EOF-<span class="number">1482539973400</span>-</span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">206</span> Partial Content</span><br><span class="line">Date: Sat, <span class="number">24</span> Dec <span class="number">2016</span> <span class="number">00</span>:<span class="number">20</span>:<span class="number">44</span> GMT</span><br><span class="line">Expires: Sun, <span class="number">25</span> Dec <span class="number">2016</span> <span class="number">00</span>:<span class="number">20</span>:<span class="number">44</span> GMT</span><br><span class="line">Content-Length: <span class="number">2</span></span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Range: bytes <span class="number">0</span>-<span class="number">1</span>/<span class="number">4300047</span></span><br><span class="line">Content-Type: text/plain; charset=GBK</span><br><span class="line">Last-Modified: Thu, <span class="number">22</span> Dec <span class="number">2016</span> <span class="number">02</span>:<span class="number">04</span>:<span class="number">16</span> GMT</span><br><span class="line">Cache-Control: max-age=<span class="number">86400</span></span><br><span class="line">Server: nginx</span><br><span class="line">Fw-Cache-Status: hit</span><br><span class="line">Fw-Via: DISK HIT from <span class="number">61.130</span>.<span class="number">28.99</span>, DISK HIT from <span class="number">58.59</span>.<span class="number">19.104</span></span><br><span class="line">Proxy-Connection: Keep-alive</span><br></pre></td></tr></table></figure>
<p>这是第一个请求的一些详细信息，其余3个请求我就不贴了，比较占篇幅，值得注意的是，这4个请求中请求头的range每一个都不同，依次如下：</p>
<ul>
<li>bytes=0-1</li>
<li>bytes=0-4300046</li>
<li>bytes=4276224-4300046</li>
<li>bytes=8640-4276223</li>
</ul>
<h2 id="Range的诞生">Range的诞生</h2><p>Range，是在 <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html" target="_blank" rel="external">HTTP/1.1</a>里新增的一个请求头字段域。我们使用的迅雷等支持多线程下载以及断点下载的核心也是基于此重要特性。</p>
<h3 id="HTTP/1-1规范的_Range_的约定">HTTP/1.1规范的 Range 的约定</h3><p>如果Server支持 Range，首先就要告诉客户端，服务器会在响应头中添加<code>Accept-Ranges: bytes</code>来表示支持 Range 的请求，之后客户端才可能发起带 Range 的请求。不支持的话，用<code>Accept-Ranges: none</code>告知客户端，对不起，我不支持。</p>
<p>Server通过请求头中的<code>Range: bytes=0-xxx</code>来判断是否是做 Range 请求，如果这个值存在而且有效，则只发回请求的那部分文件内容，响应的状态码变成206，表示Partial Content，并设置Content-Range。如果无效，则返回416状态码，表明Request Range Not Satisfiable。如果请求头中不带 Range，那么 Server则正常响应，也不会设置 Content-Range 等。</p>
<table>
<thead>
<tr>
<th>Value</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>206</td>
<td style="text-align:center">Partial Content</td>
</tr>
<tr>
<td>416</td>
<td style="text-align:center">Range Not Satisfiable</td>
</tr>
</tbody>
</table>
<p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/terminal-http.png" alt=""></p>
<p>Range的格式为：</p>
<p><code>Range:(unit=first byte pos)-[last byte pos]</code>，即<code>Range: 单位（如bytes）= 开始字节位置-结束字节位置</code>。</p>
<p>我们再来看个例子。假设我们要开启多线程下载，需要把一个大文件分割成多个部分进行下载，比如4个部分，然后创建4个线程，每个线程负责下载一个部分，如果文件大小为 5000 个 byte（随意的数字），那么我们可以划分为</p>
<ul>
<li>Range: bytes=0-1199  头1200个字节</li>
<li>Range: bytes=1200-2399 第二个1200字节</li>
<li>Range: bytes=2400-3599 第三个1200字节</li>
<li>Range: bytes=3600-5000 最后的1400字节</li>
</ul>
<p>服务器给出响应：</p>
<p>// 第1个响应</p>
<ul>
<li>Content-Length：1200</li>
<li>Content-Range：bytes 0-1199/5000</li>
</ul>
<p>// 第2个响应</p>
<ul>
<li>Content-Length：1200</li>
<li>Content-Range：bytes 1200-2399/5000</li>
</ul>
<p>// 第3个响应</p>
<ul>
<li>Content-Length：1200</li>
<li>Content-Range：bytes 2400-3599/5000</li>
</ul>
<p>// 第4个响应</p>
<ul>
<li>Content-Length：1400</li>
<li>Content-Range：bytes 3600-5000/5000</li>
</ul>
<p>如果每个请求都成功了，服务器返回的response头中有一个 Content-Range 的字段域，Content-Range 用于响应头，告诉了客户端发送了多少数据，它描述了响应覆盖的范围和整个实体长度。一般格式：</p>
<p><code>Content-Range: bytes (unit first byte pos) - [last byte pos]/[entity length]</code>即<code>Content-Range：字节 开始字节位置-结束字节位置／文件大小</code>。</p>
<h1 id="小结">小结</h1><p>HTTP协议博大精深，设计有很多巧妙的地方，Range也许就是一处吧。</p>
<h1 id="更多阅读">更多阅读</h1><ul>
<li><a href="https://tools.ietf.org/html/rfc7233" target="_blank" rel="external">RFC RangeRequest文档</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/20/iOS HTTPS迁移之路-3. 了解SPDY协议/" itemprop="url">
                  iOS HTTPS迁移之路-3. 了解SPDY协议
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-20T07:20:00+08:00" content="Aug 20 2016">
              Aug 20 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ios/" itemprop="url" rel="index">
                    <span itemprop="name">ios</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/20/iOS HTTPS迁移之路-3. 了解SPDY协议/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/20/iOS HTTPS迁移之路-3. 了解SPDY协议/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>SPDY 即“Speedy”发音，有速度之意，从名字便可知谷歌当年提出的这个方案的目标就是为了解决 HTTP 的性能瓶颈，缩短 web 页面的 load 时间。SPDY 是一个二进制协议，并不像 HTTP 那样直观易读。</p>
<h1 id="SPDY_的设计">SPDY 的设计</h1><p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/HTTP.003.png" alt=""></p>
<h1 id="SPDY_解决的问题">SPDY 解决的问题</h1><ul>
<li>多路复用：这名字听起来很高大上。其实理解起来，就是在一个 TCP 连接中，分出了多个 SPDY Stream 流通道，每个通道是并行的，不用相互等待，且各自负责一个请求和响应。这无疑会降低延迟和提升带宽的使用率。之前 HTTP/1.1 就面临着 head-of-line blocking 队首阻塞问题，也就是一个 response 响应如果迟迟没有回来，会阻塞住后续的 response 响应。后面我们用 WWDC 的一些截图来说明问题。</li>
<li>请求优先级：SPDY 允许为通道中的请求设置优先级，使得高优先级的请求能够优先得到回复响应。</li>
<li>请求头部压缩：我们知道，HTTP 协议是无状态的，无法对之前的请求和响应状态进行管理，而 Cookie 的引入正是为了解决这个问题。服务端通过客户端发送的 Cookie 来知晓是哪个客户端发送的 HTTP 请求，从而进行后续的操作。在 HTTP 请求的头部，还有一个 User Agent，这个字段携带着客户端的一些信息，如 iOS/Android 系统版本等信息。显而易见的是，Cookie 以及 User Agent 在每次的请求中会被携带进去，会耗费一定的流量。SPDY能够对 HTTP 请求头部进行压缩，会一定程度上节省不少流量。</li>
<li>服务器推送：HTTP 请求一般由客户端主动发送，服务端进行响应。而 SPDY 可以让服务端将客户端需要的内容 push 过去，不需要被动的等待客户端发送请求。有点像我们目前的 socket 连接下的服务器推送。</li>
</ul>
<h1 id="关于多路复用">关于多路复用</h1><p>我们使用【WWDC2014 707 Session whats_new_in_foundation_networking】中的几张图来说明下问题：</p>
<p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/WX20161214-093524.png" alt=""></p>
<center>图1: HTTP/1.1 未使用 pipelining</center><br><img src="http://7u2lyz.com1.z0.glb.clouddn.com/WX20161214-093500.png" alt=""><br><center>图2: HTTP/1.1 使用 pipelining</center><br><img src="http://7u2lyz.com1.z0.glb.clouddn.com/WX20161214-093554.png" alt=""><br><center>图3: SPDY 多路复用</center>

<ul>
<li><p><strong>图1: HTTP/1.1 未使用 pipelining</strong></p>
<p>  <code>style.css</code>和<code>data.xml</code>的请求必须在收到<code>image.jpg</code>的 response 之后才能依次发送出去，可想而知，这种方式会造成高延迟和低带宽使用率。</p>
</li>
<li><p><strong>图2: HTTP/1.1 使用 pipelining</strong></p>
<p>  <code>style.css</code>和<code>data.xml</code>的请求不必等到<code>image.jpg</code>响应回来之后才进行发送，而是在<code>image.jpg</code>请求发出去之后就依次发送了出去，而<code>style.css</code>和<code>data.xml</code>的响应（图中深色部分）必须要在<code>image.jpg</code>的响应之后。如果<code>image.jpg</code>请求的响应数据量比较大（图片较大），加之网络延迟严重等因素，会造成<code>style.css</code>和<code>data.xml</code>的响应迟迟不能回来，而对于网页渲染而言，资源的优先级却是<code>data.xml</code>为最高优先级，<code>style.css</code>资源为次优先级，<code>image.jpg</code>为最低，最高优先级的资源却被最低优先级的资源请求影响，也就是受到了<code>image.jpg</code>响应的阻塞，即<code>head-of-line blocking</code>队首阻塞。</p>
</li>
<li><p><strong>图3: SPDY 多路复用</strong></p>
<p>  我们从图中看到，SPDY的多路复用，从请求的发送时序上和<code>HTTP/1.1</code>使用<code>pipelining</code>是一样的，关键不同的地方在于响应返回时序上。在这个 TCP 连接中，分出了3个<code>SPDY Stream</code>流通道，即<code>image</code>，<code>style.css</code>, <code>data.xml</code>3个资源对应的流通道，每个通道各自负责一个请求和响应，并行且不用相互等待。</p>
</li>
</ul>
<h1 id="我该使用_SPDY_么？">我该使用 SPDY 么？</h1><ul>
<li>更好的用户体验<ul>
<li>对于长连接的延迟的减少可以明显改善用户体验。</li>
<li>苹果发现：在某些情况下，SPDY速度要比 HTTP/1.1 快25%。</li>
</ul>
</li>
<li>额外的获益<ul>
<li>减少 CPU 的使用率（一次SSL握手过程取代多次）</li>
<li>相同的服务器架构支持更多的客户端连接</li>
</ul>
</li>
</ul>
<p>SPDY 并不是总优于 HTTP/1.1：</p>
<ol>
<li>HTTP/1.1使用多个并行TCP连接要比SPDY的单个TCP连接要快。</li>
<li>许多SPDY的实现因为 CRIME 漏洞的影响禁用了头部压缩，所以头部压缩并不能带来很大的收益。</li>
</ol>
<h1 id="iOS8启用SPDY">iOS8启用SPDY</h1><p>苹果于 iOS8 和 OSX Yosemite 后支持了SPDY，<code>NSURLSession</code>默认就支持了SPDY，支持的版本范围有 SPDY/2，SPDY/3，SPDY/3.1。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSURL *url = [NSURL URLWithString:@&#34;https://www.example.com/&#34;];&#10;NSURLSessionDataTask *task = [[NSURLSession sharedSession]&#10;                              dataTaskWithURL:url&#10;                              completionHandler:^(NSData *data, NSURLResponse *response, NSError *error)&#123;&#10;                              &#10;                              &#125;];&#10;[task resume];</span><br></pre></td></tr></table></figure>
<p>将会默认启用SPDY，原来的代码不用做任何的改变。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/18/iOS HTTPS迁移之路-2. 认识HTTP/" itemprop="url">
                  iOS HTTPS迁移之路-2. 认识HTTP
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-18T07:20:00+08:00" content="Aug 18 2016">
              Aug 18 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ios/" itemprop="url" rel="index">
                    <span itemprop="name">ios</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/18/iOS HTTPS迁移之路-2. 认识HTTP/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/18/iOS HTTPS迁移之路-2. 认识HTTP/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>HTTP全名<code>HyperText Transfer Protocol</code>，意为“超文本传输协议”，它是一个简单的请求-响应协议。</p>
<h2 id="HTTP的缺点">HTTP的缺点</h2><p>HTTP并不是个加密的协议，会天然的存在几个缺点：</p>
<h3 id="1-明文通信，内容很容易被窃听">1.明文通信，内容很容易被窃听</h3><p>互联网上的任何一个角落都存在通信内容被窃听的风险，被广泛使用的抓包工具如<code>Wireshark</code>,<code>Charles</code>等，都可以获取HTTP协议的请求（Request）和响应（Response）的内容，并对其处理。</p>
<p>如何解决呢？</p>
<p>通过HTTPS或者简单点对通信的内容进行加密。对通信内容加密要求客户端对HTTP报文主体内容进行加密，然后发送给服务器，为了保证这点，要求客户端和服务器同时具备加密和解密机制。该方式不同于SSL/TLS对通信线路的加密处理，所以内容仍然有可能被篡改。</p>
<h3 id="2-不验证通信双方身份，因此有可能遭遇黑客伪装客户端或者服务器的情况">2.不验证通信双方身份，因此有可能遭遇黑客伪装客户端或者服务器的情况</h3><p>在 HTTP 协议通信中，因为不存在确认通信双方身份的步骤，对于请求发送者来说，所以任何人都可以发起请求；对于服务器来说，只要接收到请求，对于不在IP和端口不在限制黑名单的发送者都会返回一个响应。</p>
<p>不验证通信双方身份，会带来什么隐患呢？</p>
<ul>
<li>通信的服务器可能是伪装的服务器</li>
<li>通信的客户端可能是伪装的客户端</li>
<li>无法抵挡DoS攻击（Denial of Service，拒绝服务器攻击）</li>
</ul>
<p>如何解决呢？</p>
<p>使用SSL/TSL证书确认机制来确认双方身份。对于 iOS 开发而言，我们可以在 App 内预埋证书，在SSL/TSL握手阶段完成与服务器双向证书的认证。关于这点，我会在后面的文章中详细提及。</p>
<h3 id="3-无法验证报文的完整性，因此可能会接收到被篡改的报文。">3.无法验证报文的完整性，因此可能会接收到被篡改的报文。</h3><p>在 HTTP 协议通信中，常常会遇到中间人攻击（Man-In-The-Middle-Attack，MITMA），通信的报文会被中间人篡改，那么怎么防止这种情况？</p>
<p>通常业内用的是 MD5 或 SHA-1 等散列值校验的方式，结合用来确认文件的数字签名方法。</p>
<h2 id="HTTP协议版本">HTTP协议版本</h2><p>目前主流的 HTTP 协议版本是 HTTP/1.1，而1.1版本却是1997年发布的。在1.1之前还有几个版本，但1.1解决了一个重要的问题。我们来看下先辈们是如何解决网络传输问题的。</p>
<p>在 HTTP/1.0 版本的时候，每进行一次 HTTP 通信就要断开一次 TCP 连接。</p>
<p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/HTTP.001.png" alt=""></p>
<p>在1.0版本的时候，浏览器在打开 web 页面的时候，会使用“并行连接”（parallel connection）的方式来同时打开多个 TCP 连接，这么做会带来什么影响？</p>
<ul>
<li>我们从图中可以看到，每次 TCP 连接的建立，需要三次握手（1.客户端：你好，我给你讲个笑话；（SYN）2.服务端：好的（ACK），你讲吧（SYN）；3.客户端：好的，我准备开始讲了（ACK）），这样会带来1.5个RTT（round-trip-time）往返延迟，这种情况在高延迟的情况下比较明显；</li>
<li>每次 TCP 的连接开始阶段，会有一个慢启动的过程，这个过程是用来了解网络路径行为，所以如果能重用要比不重用要好一些；</li>
<li>并行连接会抢夺资源，会造成一定的丢包率。</li>
</ul>
<p>而 HTTP/1.1 使用“持久连接”（persistent connection）的机制解决了这个问题。这种策略也被成为“连接重用”（connection reuse）或者“keep-alive”。通过一次 TCP 的建立，可以进行多次 HTTP 请求、响应，这种做法无疑会降低 TCP 建立、断开释放带来的开销。持续连接的机制使得 HTTP 请求可以以“管线化”（pipelining）的方式进行发送，不过 pipelining 只适用于幂等请求（如GET/HEAD等方法），非幂等请求（如PUT/POST等方法）不能使用，因为非幂等请求之间可能有前后依赖。在1.1以前的版本中，每一个 HTTP 请求都需要等待收到上一个请求响应后才能发送。管线化使得 HTTP 请求可以并行发送。1.1版本这里的进步无疑是巨大的。</p>
<p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/http-keep-alive.png" alt=""></p>
<p>基于 HTTP/1.1 或者 HTTP/2.0 的 web 通信，我们看到，connection 都是 keep-alive 的方式。为了连接重用，很少见到显式将 connection 置为 close 的。那我们想一下，什么时候会断开 TCP 连接呢？事实上，客户端和服务器通常会持久连接保持打开状态，当它们已经闲置一小段时间或者当存在大量的连接时，一些 TCP 连接会被关闭。</p>
<p>那 HTTP/1.1 这么好，为什么互联网工程任务组（IETF）还要开发 HTTP/2.0 版本？2.0解决的问题正是 1.1 版本的弊端所在。包括了几个重要的改进：</p>
<ul>
<li>多路复用</li>
<li>优先级请求</li>
<li>请求头部压缩</li>
<li>服务器推送</li>
</ul>
<p>事实上，HTTP/2.0 版本正是基于谷歌2012年提出的 SPDY 方案为原型，所以我们下一节来一起了解学习下 SPDY。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/17/iOS HTTPS迁移之路-1. 开篇/" itemprop="url">
                  iOS HTTPS迁移之路-1. 开篇
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-17T06:20:00+08:00" content="Aug 17 2016">
              Aug 17 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ios/" itemprop="url" rel="index">
                    <span itemprop="name">ios</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/17/iOS HTTPS迁移之路-1. 开篇/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/17/iOS HTTPS迁移之路-1. 开篇/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/zhuanzhuan.png" alt=""></p>
<p>转转iOS App计划着今明年能够切换到HTTPS通信，特此开这个《iOS HTTPS迁移之路》系列，记录下我在学习和研究过程中遇到的问题以及经历。如果朋友们在阅读的时候有疑问，非常欢迎留言。</p>
<p>关于HTTPS，业内我们都知道像Google、Facebook、Twitter这些巨头公司早已经实现全站HTTPS，但似乎国内的网站使用的并不是特别多。百度在实现全站HTTPS方面，走的比较靠前，除下技术驱动的因素外，经常遭到底层运行商的流量劫持也是一个不容忽视的原因。作为电商老大的淘宝目前也是全站HTTPS。而京东似乎只是在注册登陆的时候使用了HTTPS，其他仍然使用的是HTTP。新浪目前也是在着手全站HTTPS。但启用全站HTTPS并非易事，像天猫、淘宝这种体量巨大，系统复杂，改造历时数月之久。</p>
<p>不过切换到HTTPS，一切都是值得的。</p>
<p>我想从以下几个方面展开，其中涉及到了很多网络方面的知识，一来是能够让自己更全面的了解为什么从HTTP迁移到HTTPS，其中涉及到了哪些细节，二来也是对其中某部分知识查漏补缺的记录。通过这次笔记系列，我对网络安全有了一些认识，当然比较浅显，得持续学习下去。</p>
<ol>
<li><p>HTTP是什么？HTTP/1、HTTP/2与HTTPS有何区别与联系？</p>
</li>
<li><p>为什么要引入HTTPS？</p>
</li>
<li><p>启用HTTPS要解决的难题</p>
</li>
<li><p>AFNetworking3.0 HTTPS</p>
</li>
<li><p>HTTPS性能优化</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/16/hello-block-03/" itemprop="url">
                  iOS block备忘录03
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-16T20:24:20+08:00" content="Jun 16 2016">
              Jun 16 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/16/hello-block-03/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/16/hello-block-03/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Block的常见几个用途">Block的常见几个用途</h1><p>1.简化枚举</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSArray</span> *array = ...</span><br><span class="line">    [array enumerateObjectsUsingBlock:^ (id obj, <span class="type">NSUInteger</span> idx, <span class="type">BOOL</span> *stop) &#123;</span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"Object at index %lu is %@"</span>, idx, obj);</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>
<p>2.简化并发任务</p>
<ul>
<li>使用于OperationQueue</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSBlockOperation</span> *operation = [<span class="type">NSBlockOperation</span> blockOperationWithBlock:^&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// schedule task on main queue:</span></span><br><span class="line"><span class="type">NSOperationQueue</span> *mainQueue = [<span class="type">NSOperationQueue</span> mainQueue];</span><br><span class="line">[mainQueue addOperation:operation];</span><br><span class="line"></span><br><span class="line"><span class="comment">// schedule task on background queue:</span></span><br><span class="line"><span class="type">NSOperationQueue</span> *queue = [[<span class="type">NSOperationQueue</span> alloc] <span class="keyword">init</span>];</span><br><span class="line">[queue addOperation:operation];</span><br></pre></td></tr></table></figure>
<ul>
<li>使用于GCD</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t queue = dispatch_get_global_queue(<span class="type">DISPATCH_QUEUE_PRIORITY_DEFAULT</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">dispatch_async(queue, ^&#123;</span><br><span class="line">    <span class="type">NSLog</span>(@<span class="string">"Block for asynchronous execution"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/15/hello-block-02/" itemprop="url">
                  iOS block备忘录02
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-15T20:24:20+08:00" content="Jun 15 2016">
              Jun 15 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/15/hello-block-02/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/15/hello-block-02/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="循环引用的问题">循环引用的问题</h1><p>让我们先来看一段代码。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@interface MyClass ()</span><br><span class="line">@property (readonly) int val;</span><br><span class="line">@property (strong) dispatch_block_t work;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p><code>Capturing self strongly in this block is likely to lead to a retain cycle</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">@interface BlockTestView2 ()</span><br><span class="line"></span><br><span class="line">@property (readonly) int val;</span><br><span class="line">@property (nonatomic, strong) id obj;</span><br><span class="line"></span><br><span class="line">@property (strong) dispatch_block_t work;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation BlockTestView2</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithFrame:(CGRect)frame &#123;</span><br><span class="line">    self = [super initWithFrame:frame];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        _obj = @1;</span><br><span class="line">        [self setup];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)setup &#123;</span><br><span class="line">    _val = 5;</span><br><span class="line"></span><br><span class="line">    // retain cycle</span><br><span class="line">    self.work = ^&#123;</span><br><span class="line">        NSLog(@"BlockTestView2 %d", _val);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 1. Scoping</span><br><span class="line">// Avoid capturing self</span><br><span class="line">- (void)setup1 &#123;</span><br><span class="line">    int local = self.val;</span><br><span class="line">    self.work = ^&#123;</span><br><span class="line">        NSLog(@"BlockTestView2 %d", local);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 2. Programmatically</span><br><span class="line">// nil the block property</span><br><span class="line">- (void)setup2 &#123;</span><br><span class="line">#pragma clang diagnostic push</span><br><span class="line">#pragma clang diagnostic ignored "-Warc-retain-cycles"</span><br><span class="line">    self.work = ^&#123;</span><br><span class="line">        NSLog(@"BlockTestView2 %d", _val);</span><br><span class="line">    &#125;;</span><br><span class="line">#pragma clang diagnostic pop</span><br><span class="line"></span><br><span class="line">    // nil the block property somewhere, please ignore</span><br><span class="line">    // this call at this point</span><br><span class="line">    [self cancel];</span><br><span class="line">&#125;</span><br><span class="line">- (void)cancel &#123;</span><br><span class="line">    self.work = nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 3. Attributes</span><br><span class="line">// Use __weak</span><br><span class="line">- (void)setup3 &#123;</span><br><span class="line">    __weak __typeof(self) weakSelf = self;</span><br><span class="line">    self.work = ^&#123;</span><br><span class="line">        __strong __typeof(self) strongSelf = weakSelf;</span><br><span class="line">        NSLog(@"BlockTestView2 %@", strongSelf.obj);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/15/hello-block-01/" itemprop="url">
                  iOS block备忘录01
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-15T20:22:20+08:00" content="Jun 15 2016">
              Jun 15 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/15/hello-block-01/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/15/hello-block-01/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="如何声明、定义一个Block">如何声明、定义一个Block</h1><ul>
<li><p>作为局部变量<br><code>returnType (^blockName)(parameterTypes) = ^returnType(parameters) {...};</code><br>例如：<br><code>int (^addByOneBlock)(int) = ^int(int number) { return number + 1; }</code></p>
</li>
<li><p>作为属性<br><code>@property (nonatomic, copy, nullability) returnType (^blockName)(parameterTypes);</code><br>例如：<br><code>@property (nonatomic, assign) int (^addByOneBlock)(int)</code></p>
</li>
<li><p>作为方法参数（声明）<br><code>(void)someMethodThatTakesABlock:(returnType (^nullability)(parameterTypes))blockName;</code><br>例如：<br><code>(void)someMethod:(int (^)(int))addByOneBlock;</code></p>
</li>
<li><p>方法调用的参数（调用）<br><code>[someObject someMethodThatTakesABlock:^returnType (parameters) {...}];</code><br>例如：<br><code>[someObject someMethod:^int (int number) { return number + 1; }];</code></p>
</li>
<li><p>typedef</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">typedef returnType (^<span class="type">TypeName</span>)(parameterTypes);</span><br><span class="line"><span class="type">TypeName</span> blockName = ^returnType(parameters) &#123;...&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>例如：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typedef void(^<span class="type">SDWebImageQueryCompletedBlock</span>)(<span class="type">UIImage</span> *image, <span class="type">SDImageCacheType</span> cacheType);</span><br><span class="line"></span><br><span class="line">typedef void(^<span class="type">SDWebImageCheckCacheCompletionBlock</span>)(<span class="type">BOOL</span> isInCache);</span><br><span class="line"></span><br><span class="line">typedef void(^<span class="type">SDWebImageCalculateSizeBlock</span>)(<span class="type">NSUInteger</span> fileCount, <span class="type">NSUInteger</span> totalSize);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^ &#36820;&#22238;&#20540;&#31867;&#22411; (&#21442;&#25968;&#21015;&#34920;) &#123; &#34920;&#36798;&#24335; &#125;&#10;          |&#10;          | &#30465;&#30053; &#36820;&#22238;&#20540;&#31867;&#22411;&#10;          |&#10;^ (&#21442;&#25968;&#21015;&#34920;) &#123; &#34920;&#36798;&#24335; &#125;&#10;          |&#10;          | &#24403;&#19981;&#20351;&#29992;&#21442;&#25968;&#26102;&#65292;&#21487;&#20197;&#30465;&#30053; (&#21442;&#25968;&#21015;&#34920;)&#10;          |&#10;^ &#123; &#34920;&#36798;&#24335; &#125;&#10;&#10;-------------------&#10;Example:&#10;&#10;^int (int count) &#123; return count + 1; &#125;&#10;          |&#10;          |&#10;          |&#10;^(int count) &#123; return count + 1; &#125;&#10;          |&#10;          |&#10;          |&#10;^ &#123; NSLog(@&#34;HelloWorld!&#34;); &#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/04/《元素模式》读书笔记01/" itemprop="url">
                  《元素模式》读书笔记01
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-04T09:34:11+08:00" content="Apr 4 2016">
              Apr 4 2016
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/04/《元素模式》读书笔记01/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/04/《元素模式》读书笔记01/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
          
          
            <div class="post-gallery-row">
              <a class="post-gallery-img fancybox"
                 href="http://7u2lyz.com1.z0.glb.clouddn.com/ElementalDesignPatternsCover.jpg" rel="gallery_ciytkgpzw001ce8fulnvchgqi"
                 itemscope itemtype="http://schema.org/ImageObject" itemprop="url">
                <img src="http://7u2lyz.com1.z0.glb.clouddn.com/ElementalDesignPatternsCover.jpg" itemprop="contentUrl"/>
              </a>
            
          

          
          </div>
        </div>
      

      
        
          《Elemental Design Patterns》 Jason McC. Smith
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/04/04/《元素模式》读书笔记01/">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/28/近期技术思考/" itemprop="url">
                  近期技术思考
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-28T18:00:00+08:00" content="Nov 28 2015">
              Nov 28 2015
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ios/" itemprop="url" rel="index">
                    <span itemprop="name">ios</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/28/近期技术思考/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/11/28/近期技术思考/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="http://7u2lyz.com1.z0.glb.clouddn.com/thinking.png" alt=""></p>
<p>博客半年没有更新了，自己在嘀嗒拼车的这半年里，更多的是对自己写的代码的一些反思，特此书写记录下来。</p>
<ul>
<li>代码如何写的优雅？</li>
<li>这段代码是否写的很罗嗦？</li>
<li>是否可以换一种写法或者是否能够应用某个设计模式很好的解决这个问题？</li>
<li>···</li>
</ul>
<h1 id="谈代码的坏味道">谈代码的坏味道</h1><p>有味道的代码永远都存在的，每个人都或多或少不定期的产生一些垃圾代码，而产生此类代码的原因一般都有哪些原因？我曾经问过自己这样的问题。常见的几个原因有以下几个：</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/11/28/近期技术思考/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="ChildhoodAndy" />
          <p class="site-author-name" itemprop="name">ChildhoodAndy</p>
          <p class="site-description motion-element" itemprop="description">思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">61</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">117</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://www.github.com/dabing1022" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/childhoodandy" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/1297984304" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://stackoverflow.com/users/1986621" target="_blank" title="StackOverflow">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  StackOverflow
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友链
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://zengrong.net/" title="曾嵘" target="_blank">曾嵘</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://post.justbilt.com/" title="justblit" target="_blank">justblit</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://yulingtianxia.com" title="玉令天下" target="_blank">玉令天下</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://mokai.github.io" title="mokai" target="_blank">mokai</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://theme-next.iissnan.com/" title="NexT-Help" target="_blank">NexT-Help</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.ibireme.com/" title="ibireme" target="_blank">ibireme</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ChildhoodAndy</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"ChildhoodAndy"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  






  
  
  

  

  

</body>
</html>
