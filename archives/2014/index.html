<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2014 | HappyCoding:)ChildhoodAndy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。">
<meta property="og:type" content="website">
<meta property="og:title" content="HappyCoding:)ChildhoodAndy">
<meta property="og:url" content="dabing1022.github.io/archives/2014/index.html">
<meta property="og:site_name" content="HappyCoding:)ChildhoodAndy">
<meta property="og:description" content="思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HappyCoding:)ChildhoodAndy">
<meta name="twitter:description" content="思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。">
  
    <link rel="alternative" href="/atom.xml" title="HappyCoding:)ChildhoodAndy" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ChildhoodAndy</a></h1>
		</hgroup>

		
		<p class="header-subtitle">思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。</p>
		
		
		<form><input type="text" class="search" placeholder=" Search..."></form>
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives/">所有文章</a></li>
				        
							<li><a href="/tags/">标签云</a></li>
				        
							<li><a href="/about/">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="/dabing1022@gmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://www.github.com/dabing1022" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/childhoodandy" title="Twitter"></a></li>
					        
								<li id="StackOverflow"><a class="StackOverflow" target="_blank" href="http://stackoverflow.com/users/1986621" title="StackOverflow"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/BMFont/" style="font-size: 10px;">BMFont</a> <a href="/tags/Bitmap-Font-Generator/" style="font-size: 10px;">Bitmap Font Generator</a> <a href="/tags/Box2D/" style="font-size: 15px;">Box2D</a> <a href="/tags/CCTableView/" style="font-size: 10px;">CCTableView</a> <a href="/tags/Chipmunk/" style="font-size: 17.5px;">Chipmunk</a> <a href="/tags/Chipmunk2D/" style="font-size: 10px;">Chipmunk2D</a> <a href="/tags/Cocoapods/" style="font-size: 17.5px;">Cocoapods</a> <a href="/tags/Cocoapods升级/" style="font-size: 10px;">Cocoapods升级</a> <a href="/tags/Cocos2d-iPhone/" style="font-size: 12.5px;">Cocos2d-iPhone</a> <a href="/tags/CoreData/" style="font-size: 17.5px;">CoreData</a> <a href="/tags/Glyph-Designer/" style="font-size: 10px;">Glyph Designer</a> <a href="/tags/HeartOfTheCity/" style="font-size: 15px;">HeartOfTheCity</a> <a href="/tags/ITC/" style="font-size: 10px;">ITC</a> <a href="/tags/Lua/" style="font-size: 15px;">Lua</a> <a href="/tags/MagicalRecord/" style="font-size: 17.5px;">MagicalRecord</a> <a href="/tags/PhysicsEngine/" style="font-size: 10px;">PhysicsEngine</a> <a href="/tags/PhysicsJointDistance/" style="font-size: 10px;">PhysicsJointDistance</a> <a href="/tags/Prelease/" style="font-size: 10px;">Prelease</a> <a href="/tags/Python/" style="font-size: 12.5px;">Python</a> <a href="/tags/RGBA8888/" style="font-size: 10px;">RGBA8888</a> <a href="/tags/ShoeBox/" style="font-size: 10px;">ShoeBox</a> <a href="/tags/TheNatureOfCode/" style="font-size: 10px;">TheNatureOfCode</a> <a href="/tags/UDID/" style="font-size: 10px;">UDID</a> <a href="/tags/UUID/" style="font-size: 10px;">UUID</a> <a href="/tags/WorldOfWarcraft/" style="font-size: 10px;">WorldOfWarcraft</a> <a href="/tags/app/" style="font-size: 10px;">app</a> <a href="/tags/build/" style="font-size: 10px;">build</a> <a href="/tags/categorybitmask/" style="font-size: 10px;">categorybitmask</a> <a href="/tags/chainable/" style="font-size: 10px;">chainable</a> <a href="/tags/cocos2d/" style="font-size: 15px;">cocos2d</a> <a href="/tags/cocos2dx/" style="font-size: 15px;">cocos2dx</a> <a href="/tags/collision/" style="font-size: 12.5px;">collision</a> <a href="/tags/collisionBitmask/" style="font-size: 10px;">collisionBitmask</a> <a href="/tags/contactBitmask/" style="font-size: 10px;">contactBitmask</a> <a href="/tags/cpPinJont/" style="font-size: 10px;">cpPinJont</a> <a href="/tags/credentials/" style="font-size: 10px;">credentials</a> <a href="/tags/exporter/" style="font-size: 10px;">exporter</a> <a href="/tags/filter/" style="font-size: 10px;">filter</a> <a href="/tags/focusbooster/" style="font-size: 10px;">focusbooster</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/google/" style="font-size: 10px;">google</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a> <a href="/tags/iPhone/" style="font-size: 10px;">iPhone</a> <a href="/tags/ios/" style="font-size: 12.5px;">ios</a> <a href="/tags/ios模拟器/" style="font-size: 10px;">ios模拟器</a> <a href="/tags/ipad/" style="font-size: 10px;">ipad</a> <a href="/tags/leak/" style="font-size: 10px;">leak</a> <a href="/tags/libLua-a/" style="font-size: 10px;">libLua.a</a> <a href="/tags/lua/" style="font-size: 10px;">lua</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/objective-c/" style="font-size: 10px;">objective-c</a> <a href="/tags/performselector/" style="font-size: 10px;">performselector</a> <a href="/tags/physicseditor/" style="font-size: 10px;">physicseditor</a> <a href="/tags/pod/" style="font-size: 10px;">pod</a> <a href="/tags/push/" style="font-size: 10px;">push</a> <a href="/tags/query/" style="font-size: 10px;">query</a> <a href="/tags/quick/" style="font-size: 12.5px;">quick</a> <a href="/tags/quick-cocos2dx/" style="font-size: 10px;">quick-cocos2dx</a> <a href="/tags/quick-x/" style="font-size: 10px;">quick-x</a> <a href="/tags/remove/" style="font-size: 10px;">remove</a> <a href="/tags/replace/" style="font-size: 10px;">replace</a> <a href="/tags/scene/" style="font-size: 10px;">scene</a> <a href="/tags/scrapy/" style="font-size: 10px;">scrapy</a> <a href="/tags/search/" style="font-size: 10px;">search</a> <a href="/tags/statemachine/" style="font-size: 10px;">statemachine</a> <a href="/tags/syntax/" style="font-size: 10px;">syntax</a> <a href="/tags/table/" style="font-size: 10px;">table</a> <a href="/tags/tolua/" style="font-size: 10px;">tolua</a> <a href="/tags/v1-1-0/" style="font-size: 10px;">v1.1.0</a> <a href="/tags/venture-partners/" style="font-size: 10px;">venture-partners</a> <a href="/tags/warning/" style="font-size: 10px;">warning</a> <a href="/tags/wax/" style="font-size: 10px;">wax</a> <a href="/tags/中文/" style="font-size: 10px;">中文</a> <a href="/tags/事件流/" style="font-size: 10px;">事件流</a> <a href="/tags/位图字体/" style="font-size: 10px;">位图字体</a> <a href="/tags/创业/" style="font-size: 12.5px;">创业</a> <a href="/tags/删除/" style="font-size: 12.5px;">删除</a> <a href="/tags/发布/" style="font-size: 10px;">发布</a> <a href="/tags/吞噬/" style="font-size: 10px;">吞噬</a> <a href="/tags/多重继承/" style="font-size: 10px;">多重继承</a> <a href="/tags/心城/" style="font-size: 20px;">心城</a> <a href="/tags/情境/" style="font-size: 10px;">情境</a> <a href="/tags/情感/" style="font-size: 15px;">情感</a> <a href="/tags/拒绝/" style="font-size: 10px;">拒绝</a> <a href="/tags/搜索引擎/" style="font-size: 10px;">搜索引擎</a> <a href="/tags/数据采集/" style="font-size: 10px;">数据采集</a> <a href="/tags/数组/" style="font-size: 10px;">数组</a> <a href="/tags/概念图/" style="font-size: 10px;">概念图</a> <a href="/tags/添加图片/" style="font-size: 10px;">添加图片</a> <a href="/tags/爬虫/" style="font-size: 12.5px;">爬虫</a> <a href="/tags/版本/" style="font-size: 10px;">版本</a> <a href="/tags/物理引擎/" style="font-size: 10px;">物理引擎</a> <a href="/tags/状态机/" style="font-size: 10px;">状态机</a> <a href="/tags/用户/" style="font-size: 10px;">用户</a> <a href="/tags/番茄工作法/" style="font-size: 10px;">番茄工作法</a> <a href="/tags/碰撞查询/" style="font-size: 10px;">碰撞查询</a> <a href="/tags/碰撞过滤/" style="font-size: 10px;">碰撞过滤</a> <a href="/tags/移除/" style="font-size: 10px;">移除</a> <a href="/tags/纹理/" style="font-size: 10px;">纹理</a> <a href="/tags/编程模拟自然系统/" style="font-size: 10px;">编程模拟自然系统</a> <a href="/tags/联想词/" style="font-size: 10px;">联想词</a> <a href="/tags/触摸/" style="font-size: 10px;">触摸</a> <a href="/tags/设备信息/" style="font-size: 10px;">设备信息</a> <a href="/tags/账户密码/" style="font-size: 10px;">账户密码</a> <a href="/tags/距离关节/" style="font-size: 10px;">距离关节</a> <a href="/tags/输入/" style="font-size: 10px;">输入</a> <a href="/tags/链式语法/" style="font-size: 10px;">链式语法</a> <a href="/tags/销关节/" style="font-size: 10px;">销关节</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://zengrong.net/">曾嵘</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://post.justbilt.com/">justblit</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://yulingtianxia.com">玉令天下</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://mokai.github.io">mokai</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">热爱编码，希望家人幸福安康</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">ChildhoodAndy</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="回到主页">ChildhoodAndy</a></h1>
			</hgroup>
			
			<p class="header-subtitle">思维世界的发展，在某种意义上说，就是对惊奇的不断摆脱。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives/">所有文章</a></li>
		        
					<li><a href="/tags/">标签云</a></li>
		        
					<li><a href="/about/">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="/dabing1022@gmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://www.github.com/dabing1022" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/childhoodandy" title="Twitter"></a></li>
					        
								<li id="StackOverflow"><a class="StackOverflow" target="_blank" href="http://stackoverflow.com/users/1986621" title="StackOverflow"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-new-labels-data-concept-map" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/12/29/new-labels-data-concept-map/" class="article-date">
  	<time datetime="2014-12-28T22:26:00.000Z" itemprop="datePublished">12月 29 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/29/new-labels-data-concept-map/">新版标签、数据概念图</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>《心城》1.3.0版本目前可以在AppStore<a href="https://itunes.apple.com/cn/app/xin-cheng/id923226261?l=zh&amp;mt=8" target="_blank" rel="external">下载</a>。</p>
<p>迭代的这几个版本，还没有正式迈入到我们设想的功能点。</p>
<p>在下面的1.4.0版本中，我们俩决定按照之前设想的，加入标签系统，这套系统会成为组织数据的一个核心，今天上午我自己出了个概念图，不过当务之急要将功能、流程走通。</p>
<p><img src="http://childhoodgamedev.qiniudn.com/xincheng_2.png" alt=""></p>
<p><img src="http://childhoodgamedev.qiniudn.com/xincheng_1.png" alt=""></p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/创业/">创业</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/概念图/">概念图</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-resolving-pod-search-the-warehouse-below-the-github-repository-version-of-method" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/12/26/resolving-pod-search-the-warehouse-below-the-github-repository-version-of-method/" class="article-date">
  	<time datetime="2014-12-25T18:19:00.000Z" itemprop="datePublished">12月 26 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/26/resolving-pod-search-the-warehouse-below-the-github-repository-version-of-method/">解决pod search出来的仓库版本低于github仓库版本的方法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="问题描述">问题描述</h1><p>我们在用 Cocoapods 做第三方开源库管理的时候，有时候发现</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pod search XXX</span><br></pre></td></tr></table></figure>
<p>版本低于github上仓库的最新release版本 （注：XXX为仓库名称）</p>
<h1 id="解决方法–&gt;升级Cocoapods版本">解决方法–&gt;升级Cocoapods版本</h1><p>查看当前系统Cocoapods版本命令：<code>pod --version</code></p>
<h2 id="升级方法">升级方法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gem update --system</span><br><span class="line">$ gem sources --remove https://rubygems.org/ </span><br><span class="line">$ gem sources <span class="operator">-a</span> http://ruby.taobao.org/ </span><br><span class="line">$ sudo gem install cocoapods</span><br><span class="line">$ pod setup</span><br></pre></td></tr></table></figure>
<p>其中<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gem sources --remove https://rubygems.org/ </span><br><span class="line">$ gem sources <span class="operator">-a</span> http://ruby.taobao.org/</span><br></pre></td></tr></table></figure></p>
<p>这两句话可以省略，但我们在天朝，还是加上的好。国内网络原因（你懂的），如果使用原来的<code>https://rubygems.org/</code>，那么在<code>sudo gem install cocoapods</code>的时候，存放在 Amazon S3 上面的资源文件间歇性连接失败。</p>
<p>升级结束后再次<code>pod --version</code>，会发现 Cocoapods 版本号高于之前的版本，升级成功了。</p>
<p>再次<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pod search XXX</span><br></pre></td></tr></table></figure></p>
<p>OK，github仓库的最新版已经有了。</p>
<ul>
<li>原文链接：<a href="https://github.com/dabing1022/Blog/issues/3" target="_blank" rel="external">https://github.com/dabing1022/Blog/issues/3</a></li>
<li>问题经过：<a href="https://github.com/HeshamMegid/HMSegmentedControl/issues/77" target="_blank" rel="external">https://github.com/HeshamMegid/HMSegmentedControl/issues/77</a></li>
</ul>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ios/">ios</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocoapods升级/">Cocoapods升级</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pod/">pod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/search/">search</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-ios-performselector-may-cause-a-leak-because-its-selector-is-unknown-warning-cause-and-its-solution" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/12/01/ios-performselector-may-cause-a-leak-because-its-selector-is-unknown-warning-cause-and-its-solution/" class="article-date">
  	<time datetime="2014-12-01T00:36:00.000Z" itemprop="datePublished">12月 1 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/01/ios-performselector-may-cause-a-leak-because-its-selector-is-unknown-warning-cause-and-its-solution/">ios之&quot;performSelector may cause a leak because its selector is unknown&quot;警告原因及其解决办法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="问题描述">问题描述</h2><p>项目中使用到了从字符串创建选择器，编译时发现警告：”performSelector may cause a leak because its selector is unknown”（因为performSelector的选择器未知可能会引起泄漏），为什么在ARC模式下会出现这个警告？</p>
<p>经过搜索后，在Stackoverflow上发现了一个令人满意的答案。见<a href="http://stackoverflow.com/questions/7017281/performselector-may-cause-a-leak-because-its-selector-is-unknown" target="_blank" rel="external">http://stackoverflow.com/questions/7017281/performselector-may-cause-a-leak-because-its-selector-is-unknown</a>。</p>
<h2 id="原因">原因</h2><p>在ARC模式下，运行时需要知道如何处理你正在调用的方法的返回值。这个返回值可以是任意值，如<code>void</code>,<code>int</code>,<code>char</code>,<code>NSString</code>,<code>id</code>等等。ARC通过头文件的函数定义来得到这些信息。所以平时我们用到的静态选择器就不会出现这个警告。因为在编译期间，这些信息都已经确定。</p>
<p>如：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...&#10;[someController performSelector:@selector(someMethod)];&#10;...&#10;- (void)someMethod&#10;&#123;&#10;  //bla bla...&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>而使用<code>[someController performSelector: NSSelectorFromString(@&quot;someMethod&quot;)];</code>时ARC并不知道该方法的返回值是什么，以及该如何处理？该忽略？还是标记为<code>ns_returns_retained</code>还是<code>ns_returns_autoreleased</code>?</p>
<h2 id="解决办法">解决办法</h2><h3 id="1-使用函数指针方式">1.使用函数指针方式</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SEL selector = NSSelectorFromString(@&#34;someMethod&#34;);&#10;IMP imp = [_controller methodForSelector:selector];&#10;void (*func)(id, SEL) = (void *)imp;&#10;func(_controller, selector);</span><br></pre></td></tr></table></figure>
<p>当有额外参数时，如</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SEL selector = NSSelectorFromString(@&#34;processRegion:ofView:&#34;);&#10;IMP imp = [_controller methodForSelector:selector];&#10;CGRect (*func)(id, SEL, CGRect, UIView *) = (void *)imp;&#10;CGRect result = func(_controller, selector, someRect, someView);</span><br></pre></td></tr></table></figure>
<h3 id="2-使用宏忽略警告">2.使用宏忽略警告</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#pragma clang diagnostic push&#10;#pragma clang diagnostic ignored &#34;-Warc-performSelector-leaks&#34;&#10;   [someController performSelector: NSSelectorFromString(@&#34;someMethod&#34;)]&#10;#pragma clang diagnostic pop</span><br></pre></td></tr></table></figure>
<p>通过使用<code>#pragma clang diagnostic push/pop</code>，你可以告诉Clang编译器仅仅为某一特定部分的代码来忽视特定警告。</p>
<p>如果需要忽视的警告有多处，可以定义一个宏</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define SuppressPerformSelectorLeakWarning(Stuff) \&#10;    do &#123; \&#10;        _Pragma(&#34;clang diagnostic push&#34;) \&#10;        _Pragma(&#34;clang diagnostic ignored \&#34;-Warc-performSelector-leaks\&#34;&#34;) \&#10;        Stuff; \&#10;        _Pragma(&#34;clang diagnostic pop&#34;) \&#10;    &#125; while (0)</span><br></pre></td></tr></table></figure>
<p>在产生警告也就是<code>performSelector</code>的地方用使用该宏，如</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SuppressPerformSelectorLeakWarning(&#10;    [_target performSelector:_action withObject:self]&#10;);</span><br></pre></td></tr></table></figure>
<p>如果需要<code>performSelector</code>返回值的话，</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id result;&#10;SuppressPerformSelectorLeakWarning(&#10;    result = [_target performSelector:_action withObject:self]&#10;);</span><br></pre></td></tr></table></figure>
<h3 id="3-使用afterDelay">3.使用afterDelay</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self performSelector:aSelector withObject:nil afterDelay:0.0];</span><br></pre></td></tr></table></figure>
<p>如果在接受范围内，允许在下一个runloop执行，可以这么做。xCode5没问题，但据反映，xCode6的话这个不能消除警告。</p>
<p>原文链接：<a href="https://github.com/dabing1022/Blog/issues/2" target="_blank" rel="external">https://github.com/dabing1022/Blog/issues/2</a></p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ios/">ios</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leak/">leak</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/performselector/">performselector</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/warning/">warning</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-walking-in-the-dark" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/08/walking-in-the-dark/" class="article-date">
  	<time datetime="2014-11-07T22:29:00.000Z" itemprop="datePublished">11月 8 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/08/walking-in-the-dark/">行走在黑暗中</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>2014年11月08号，心城v1.1.0通过了苹果的审核。如果阅读过前面<a href="http://childhood.logdown.com/posts/238638/110-today-submitted-for-review" target="_blank" rel="external">心城1.1.0今天提交审核了</a>的朋友们会发现，时间俨然过了2周多。期间发生了什么事情？正常的Waiting For Review进入InReview大概1周差不多，这次怎么两周多了？</p>
<p>被拒了一次。</p>
<p>来看下被拒的原因吧，希望后面的朋友别和我一样。</p>
<h1 id="1-问题描述">1.问题描述</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Reasons</span><br><span class="line">2.23: Apps must follow the iOS Data Storage Guidelines or they will be rejected</span><br><span class="line">3.3: Apps with names, descriptions, screenshots, or previews not relevant to the content and functionality of the App will be rejected</span><br><span class="line">----- 2.23 -----</span><br><span class="line"></span><br><span class="line">We found that your app does not follow the iOS Data Storage Guidelines, which is required per the App Store Review Guidelines.</span><br><span class="line"></span><br><span class="line">In particular, we found that on launch and/or content download, your app stores 2.04MB. To check how much data your app is storing:</span><br><span class="line"></span><br><span class="line">- Install and launch your app</span><br><span class="line">- Go to Settings &gt; iCloud &gt; Storage &amp; Backup &gt; Manage Storage</span><br><span class="line">- If necessary, tap "Show all apps"</span><br><span class="line">- Check your app's storage</span><br><span class="line"></span><br><span class="line">The iOS Data Storage Guidelines indicate that only content that the user creates using your app, e.g., documents, new files, edits, etc., should be backed up by iCloud.</span><br><span class="line"></span><br><span class="line">Temporary files used by your app should only be stored in the /tmp directory; please remember to delete the files stored in this location when the user exits the app.</span><br><span class="line"></span><br><span class="line">Data that can be recreated but must persist for proper functioning of your app - or because customers expect it to be available for offline use - should be marked with the "do not back up" attribute. For NSURL objects, add the NSURLIsExcludedFromBackupKey attribute to prevent the corresponding file from being backed up. For CFURLRef objects, use the corresponding kCFURLIsExcludedFromBackupKey attribute.</span><br><span class="line"></span><br><span class="line">For more information, please see Technical Q&amp;A 1719: How do I prevent files from being backed up to iCloud and iTunes?.</span><br><span class="line"></span><br><span class="line">It is necessary to revise your app to meet the requirements of the iOS Data Storage Guidelines.</span><br><span class="line"></span><br><span class="line">----- 3.3 -----</span><br><span class="line"></span><br><span class="line">In addition, your marketing screenshots do not sufficiently reflect the app in use, which does not give the user an accurate understanding of what the app does, as required by the App Store Review Guidelines.</span><br><span class="line"></span><br><span class="line">We’ve attached the relevant screenshot(s) for your reference.</span><br><span class="line"></span><br><span class="line">It would be appropriate to revise your screenshots to demonstrate the app functionality in use.</span><br><span class="line"></span><br><span class="line">If your iTunes Connect Application State is Rejected, a new binary will be required. Make the desired metadata changes when you upload the new binary.</span><br><span class="line"></span><br><span class="line">For discrete code-level questions, you may wish to consult with Apple Developer Technical Support. When the DTS engineer follows up with you, please be ready to provide:</span><br><span class="line"></span><br><span class="line">- complete details of your rejection issue(s)</span><br><span class="line">- screenshots</span><br><span class="line">- steps to reproduce the issue(s)</span><br><span class="line">- symbolicated crash logs - if your issue results in a crash log</span><br></pre></td></tr></table></figure>
<p>一共两个原因。<br>分别对应苹果审核规则的2.23和3.3规则。</p>
<h1 id="2-先说3-3_元数据问题">2.先说3.3 元数据问题</h1><p>截图不够丰富，表达不了应用的功能，增加了3张图片解决问题。</p>
<h1 id="3-再谈2-23_数据存储问题">3.再谈2.23 数据存储问题</h1><p>心城将用户拍照以及头像设置的图片以及用户的录音文件都保存在了沙箱Documents文件夹，MagicalRecord用的数据库文件默认存放在了<code>Library/Application Support</code>目录下。</p>
<p>我举个例子来说明：</p>
<h2 id=""><img src="http://childhoodgamedev.qiniudn.com/xincheng_QQ20141108-1.png" alt=""></h2><p>Documents下的文件是会被 iCloud 自动备份的，苹果的测试人员发现，他们拍了一些照片，录制一些音频，然后退出应用，同步iCloud发现数据有2.04M，很明显，照片和音频数据以及数据库文件（存放在Library下的ApplicationSupport下，同样会被iCloud自动同步）是造成这2.04M的罪魁祸首，所以被拒。</p>
<p>究其原因是我<em>存储文件的位置不对或者说是规则不对</em>造成的。为了避免被 iCloud 同步，需要对这些文件进行“不备份标记”。将文件夹标记为不备份，那么其子文件和子文件夹都不会被备份。这里还不敢对 Documents 标记不备份，那样“太过分了”，毕竟还有其他数据和文稿需要备份。对Documents下的不需要的文件夹进行标记即可。</p>
<p>和一个朋友交流中，他提到了他以前犯过的一个错误，他的应用在访问网络时，把一些图片存放在了 Documents 文件夹里面了，也是导致被拒，这些图片应该视情况放在tmp或者cache里面。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//沙盒Documents目录路径</span></span><br><span class="line"> <span class="preprocessor">#<span class="keyword">define</span> DOC_PATH ([NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:<span class="number">0</span>])</span></span><br><span class="line"><span class="comment">//沙盒Cache目录路径</span></span><br><span class="line"> <span class="preprocessor">#<span class="keyword">define</span> CACHE_PATH ([NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) objectAtIndex:<span class="number">0</span>])</span></span><br><span class="line"><span class="comment">//沙盒Library目录路径</span></span><br><span class="line"> <span class="preprocessor">#<span class="keyword">define</span> LIB_PATH ([NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES) objectAtIndex:<span class="number">0</span>])</span></span><br><span class="line"><span class="comment">//沙盒Temp目录路径</span></span><br><span class="line"> <span class="preprocessor">#<span class="keyword">define</span> TEMP_PATH (NSTemporaryDirectory())</span></span><br><span class="line"> <span class="comment">// app data directory name</span></span><br><span class="line"> <span class="preprocessor">#<span class="keyword">define</span> APP_DATA_PHOTOS_DIR_NAME     @<span class="string">"photos"</span></span></span><br><span class="line"> <span class="preprocessor">#<span class="keyword">define</span> APP_DATA_AUDIOS_DIR_NAME     @<span class="string">"audios"</span></span></span><br><span class="line"> <span class="preprocessor">#<span class="keyword">define</span> APP_DATA_AVATARS_DIR_NAME    @<span class="string">"avatars"</span></span></span><br><span class="line"></span><br><span class="line">-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//.....</span></span><br><span class="line">  [self addSkipBackup];</span><br><span class="line">  <span class="comment">//.....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)addSkipBackup</span><br><span class="line">&#123;</span><br><span class="line">  NSString* photoDirPath = [DOC_PATH stringByAppendingPathComponent:APP_DATA_PHOTOS_DIR_NAME];</span><br><span class="line">  NSString* audioDirPath = [DOC_PATH stringByAppendingPathComponent:APP_DATA_AUDIOS_DIR_NAME];</span><br><span class="line">  NSString* avatarDirPath = [DOC_PATH stringByAppendingPathComponent:APP_DATA_AVATARS_DIR_NAME];</span><br><span class="line"></span><br><span class="line">  [self addSkipBackupAttributeToItemAtURL:[NSURL fileURLWithPath:photoDirPath]];</span><br><span class="line">  [self addSkipBackupAttributeToItemAtURL:[NSURL fileURLWithPath:audioDirPath]];</span><br><span class="line">  [self addSkipBackupAttributeToItemAtURL:[NSURL fileURLWithPath:avatarDirPath]];</span><br><span class="line">  [self addSkipBackupAttributeToItemAtURL:[NSURL fileURLWithPath:[NSPersistentStore MR_applicationStorageDirectory]]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL</span><br><span class="line">&#123;</span><br><span class="line">    assert([[NSFileManager defaultManager] fileExistsAtPath: [URL path]]);</span><br><span class="line"></span><br><span class="line">    NSError *error = nil;</span><br><span class="line">    BOOL success = [URL setResourceValue: [NSNumber numberWithBool: YES]</span><br><span class="line">                                  forKey: NSURLIsExcludedFromBackupKey error: &amp;error];</span><br><span class="line">    <span class="keyword">if</span>(!success)&#123;</span><br><span class="line">        NSLog(@<span class="string">"Error excluding %@ from backup %@"</span>, [URL lastPathComponent], error);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改之后，重新提交，漫长的WaitingForReview又重新开始。今天进入了InReview后顺利通过上架。</p>
<h1 id="4-杂说">4.杂说</h1><p>在等待的期间，v1.2.0也在另外的分支开发着。今天1.1.0上架后，v1.2.0 也做了提交。</p>
<p>v1.2.0的改动<br>1.崭新的UI界面；<br>2.增加密码锁保护隐私；<br>3.消除了5连拍时存在的闪退隐患。</p>
<p>襁褓中的心城，并不完美也并不强大，虽然收到了负面的反馈，但不妨碍我把TA坚持做下去做好的决心。</p>
<p>行走在黑暗中，也许某天，会看到光明。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/创业/">创业</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HeartOfTheCity/">HeartOfTheCity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/v1-1-0/">v1.1.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/心城/">心城</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-early-ui-options" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/24/early-ui-options/" class="article-date">
  	<time datetime="2014-10-23T21:11:00.000Z" itemprop="datePublished">10月 24 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/24/early-ui-options/">心城前期的UI选择</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://childhoodgamedev.qiniudn.com/xincheng_capicon.png" alt=""><br><img src="http://childhoodgamedev.qiniudn.com/xincheng_capicon2.png" alt=""><br><img src="http://childhoodgamedev.qiniudn.com/xincheng_capicon4.png" alt=""><br><img src="http://childhoodgamedev.qiniudn.com/xincheng_2.jpg" width="700"></p>
<p><img src="http://childhoodgamedev.qiniudn.com/xincheng_xincheng1.1.0.png" align="right"></p>
<h1 id="心城"><a href="https://itunes.apple.com/cn/app/xin-cheng/id923226261?l=zh&amp;ls=1&amp;mt=8" target="_blank" rel="external">心城</a></h1><p>在心城前期的开发过程中，因为暂时还没有美术人员，所以UI上我们会选择一些”开源“的一些好的设计。这里不得不提 mariodelvalle 的 <a href="http://mariodelvalle.github.io/CaptainIconWeb/" target="_blank" rel="external">http://mariodelvalle.github.io/CaptainIconWeb/</a> 这些优秀的设计。网站中提供有所有ICON的PSD源文件，甚至也包括了EPS、SVG矢量源文件，方便了在Illustrator下无限放大不失精度的要求。</p>
<p>感谢开源！</p>
<p>设计方面，我们会保持一个扁平的风格，一个是现在流行，另外扁平的风格的确看着特别舒服。在接受程度方面，IOS设备的使用者随着IOS7、IOS8的升级使用，对于扁平化style基本上都处于一个认可并喜欢的态度。</p>
<p>那下面 v1.2.0 这个的版本，我们会在细节和UI上处理的更好，敬请期待。也非常期待身边朋友和设计人员能给提出宝贵的意见！</p>
<hr>
<p><em>海纳百川，有容乃大。心城会在一路的荆棘和鼓励下逐渐成长。</em></p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-today-submitted-for-review" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/22/today-submitted-for-review/" class="article-date">
  	<time datetime="2014-10-21T18:35:00.000Z" itemprop="datePublished">10月 22 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/22/today-submitted-for-review/">心城1.1.0今天提交审核了</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <center><img src="http://childhoodgamedev.qiniudn.com/xincheng_xincheng1.1.0.png" alt=""></center>

<p>今天是2014年10月22号，距离上次心城1.0.0版本的提交快到了三周。在这三周里，我们围绕着身边朋友的反馈以及我们预计要做的功能，完成了1.1.0版本。</p>
<center><br><div><br><img src="http://childhoodgamedev.qiniudn.com/xincheng_appintro1.png" width="300" height="300"><br><img src="http://childhoodgamedev.qiniudn.com/xincheng_appintro2.png" width="300" height="300"><br></div><br></center>

<p>看看我们的成果！新加功能，以后会有更多！</p>
<p>1、增加了自定义背景色，颜色随心随手随时换；<br>2、增加了文本、照片两种表达方式，爱写字爱拍照的可以大展拳脚了；<br>3、增加了删除人物功能，请慎用；<br>4、调整了UI，常用功能轻点即立刻弹出，长按头像可展开更多功能。</p>
<hr>
<h2 id="小插曲">小插曲</h2><p>本来是昨天下午提交的，今天早上起来，看到一哥给我发的qq消息，我一看时间是凌晨1点多发的。他指出了新提交版本的一个问题，我核查了下代码，这个问题确实存在。</p>
<p>那么问题来了。</p>
<p>遇到这种情况，我们开发人员需要做什么工作？</p>
<h3 id="1-关于代码方面">1.关于代码方面</h3><p>我一直用的git来进行代码版本控制，新建一个“1.1.0bugFix”分支后面进行合并或者在原1.1.0分支上进行修改都可以。关键是重现 BUG，找到代码问题所在，修复后，再次测试。没问题后，重新在Xcode里面<code>Archive</code>，上传到ITC后台。</p>
<h3 id="2-ITC（ItunesConnect）方面的工作">2.ITC（ItunesConnect）方面的工作</h3><p>一般这种情况，我们需要将提交的 APP，自己手动 reject（拒绝）掉。因为ITC网站苹果改版了，最新的网站界面和以前的有很大不同，可能有时候遇到问题，google出来的解决办法或许并不使用。</p>
<p>进入 ITC 后台，在 MyApps 里面，</p>
<p><img src="http://childhoodgamedev.qiniudn.com/xincheng_reject.jpg" alt=""></p>
<p>将刚提交的版本，点击<code>remove this version from review</code>，将刚提交的版本从审核队列中移除掉。我们需要选择我们刚上传的app就可以了，而其他的元数据资料不用改动。所以在下方的<code>Build</code>一栏中，将之前的 build 删除，后面要做的就是重新 add 我们新上传的 build。</p>
<p>到这里有个问题，由于我们新上传 app，版本号仍然要保持 1.1.0，如果只修改了代码，就直接上传到ITC，在上传检查中就会报错，说你的这个 1.1.0 的 build 已经存在。问题出在了 build 的数字上面。第一次的1.1.0，在xcode项目中，Version为1.1.0，Build我也填成了1.1.0，而修改代码后，我忘记修改了Build的数字，所以会出现上面的报错信息。</p>
<p>我脑海中第一个反应，能不能在ITC里面把我上传的<code>Version 1.1.0，Build 1.1.0</code>这个提交的app prelease 删除掉。在Stackoverflow上我找到了答案，不能删除。解决方法很简单，我们重新Archive的时候，修改下Build的数值就可以了。ITC里面会记录上你同一个版本的所有Build，以Build数值来区分。</p>
<p>Build的填写没有很大要求，我这里改成了1.1.0.1。重新提交，这次顺利上传。</p>
<p><img src="http://childhoodgamedev.qiniudn.com/xincheng_build.jpg" alt="在Xcode中的设置"></p>
<p><img src="http://childhoodgamedev.qiniudn.com/xincheng_version_build.jpg" alt="在 MyApps 的 Prelease 一栏下，我们会看到同个版本的两次Build"></p>
<hr>
<p>作为一个ios开发新入门的选手，在开发的过程中遇到了许多问题，有些问题我记录在了印象笔记里，但我觉得仍然有必要把我一路过来遇到的杂七杂八的问题与大家一起分享下，在后面的文章中会陆续记录些我在心城的开发中，遇到的技术问题以及一些想法。</p>
<p>也许你曾经遇到过，也许你没有，能一起有所收获，这么做便值了。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/创业/">创业</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ITC/">ITC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Prelease/">Prelease</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/build/">build</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/删除/">删除</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/心城/">心城</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/情感/">情感</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/拒绝/">拒绝</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-it-is-late-and-we-should-all-be-ashamed" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/09/it-is-late-and-we-should-all-be-ashamed/" class="article-date">
  	<time datetime="2014-10-09T01:03:00.000Z" itemprop="datePublished">10月 9 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/09/it-is-late-and-we-should-all-be-ashamed/">它既迟，也令我们感到羞愧</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天，《心城》的1.0.0版本总算正式在App Store上发布了，这里是<a href="https://itunes.apple.com/cn/app/xin-cheng/id923226261?l=zh&amp;ls=1&amp;mt=8" target="_blank" rel="external">地址</a>。因为我前期对应用开发的不熟悉，所以花了不少时间才敢推出最基本的功能。暂时没有美术，设计上也欠缺一些。</p>
<p>它既迟，也令我们感到羞愧。</p>
<p>这么说，是因为有个老外那么说：如果你发布第一个版本时没有感到羞愧，那么它发布的一定是太晚了。</p>
<p>现有的功能，已经有用户反馈说感觉无事可做。我们只能这么解释：它不是游戏，是不会粘用户的。当用户想起某人，感觉这人是重要的，就可以在心城里添加头像，录上一段话。它不是必需的，取决于用户表达情感的意愿。决不至于让用户自作多情。</p>
<p>所以作为一个目前只有不到10M的应用，装一个，它会静静在那里等着你某个情感漫溢的瞬间。</p>
<h2 id="实用情境">实用情境</h2><p>1、总有那么一两个、三四个至亲至近的人；</p>
<p>2、忽然念想起某人，也不知道现在怎样了；</p>
<p>3、好喜欢好声音里的＊＊，就粉TA了；</p>
<p>4、梦到过世的姥姥；</p>
<p>5、喜欢对面的新同事</p>
<p>……</p>
<p>按住头像，可以录音，可是说点什么呢？</p>
<p>1、什么都不说就确定、退出录音界面，欲言又止也是一种选择；</p>
<p>2、说出你的思念；</p>
<p>3、答应为TA做一件事却不必直接告诉TA；</p>
<p>4、说“对不起”；</p>
<p>5、祝福，祈祷，愿TA一切都好；</p>
<p>……</p>
<p>人们都太忙了。</p>
<p>1、打开心城啥都不干，看着一个个头像发发呆；</p>
<p>2、翻看下过往的记录，慢慢回忆；</p>
<p>3、想想是不是该联络联络那谁谁；</p>
<p>4、那答应谁的事情差点忘了；</p>
<p>5、深情抚摸那谁的头像；</p>
<p>……</p>
<p>～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～<br>我不怕板砖，我只是认真。相信后面的版本迭代，会让心城成熟起来。</p>
<h2 id="补充说明">补充说明</h2><p>【心城】 这个关键字不是特别好，在搜索方面有些吃亏。不少应用的关键字里面，带有心字，如果在 App Store 里面搜索，输入“心城”后，类别选择【社交】，可以快速的找到。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/创业/">创业</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/发布/">发布</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/心城/">心城</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/情境/">情境</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/情感/">情感</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/用户/">用户</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-add-pictures-to-album-ios-simulator-library" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/07/add-pictures-to-album-ios-simulator-library/" class="article-date">
  	<time datetime="2014-10-06T19:45:00.000Z" itemprop="datePublished">10月 7 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/07/add-pictures-to-album-ios-simulator-library/">为ios模拟器相册库添加图片</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在app开发的时候，有时候需要用到ios模拟器中的相册图片。添加的方法非常简单，做个备注。</p>
<p>让模拟器显示Home页，拖放电脑中的图片到模拟器中，这时候模拟器的Safari浏览器会打开该图片，轻按图片数秒，会有保存菜单，保存即可。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ios/">ios</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios模拟器/">ios模拟器</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/添加图片/">添加图片</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-easy-magicalrecord-04" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/07/22/easy-magicalrecord-04/" class="article-date">
  	<time datetime="2014-07-21T18:42:00.000Z" itemprop="datePublished">7月 22 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/22/easy-magicalrecord-04/">深入浅出MagicalRecord-04</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>我们接着上一篇 <a href="http://childhood.logdown.com/posts/211016/easy-magicalrecord-03" target="_blank" rel="external">深入浅出MagicalRecord-03</a>。</p>
<p>这节我们来一起学习下 MagicalRecord 对数据的存储，内容主要来自于 <a href="https://github.com/magicalpanda/MagicalRecord/blob/develop/Docs/Saving.md" target="_blank" rel="external">MagicalRecord的github资料</a>。</p>
<h1 id="存储的时机"><i class="icon-save"> 存储的时机</i></h1><p>一般情况下，我们应该在数据发生变化时就进行存储操作。有些应用选择在退出的时候存储，然而在大多数情况下这是不必要的。<strong><em>事实上，如果你只是当应用退出的时候进行存储，你有可能会丢失数据！</em></strong>如果你的应用崩溃了呢？用户会丢失他们改变的数据，这是很糟糕的体验，应该极力去避免出现这种情况。</p>
<p>如果你发现存储比较耗时，有下面几点你可以考虑下：</p>
<p>1.<strong>利用后台线程存储</strong></p>
<p>MagicalRecord 提供了一个简洁的API来操作后台线程对实体改变的存储。例如：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[MagicalRecord saveWithBlock:^(NSManagedObjectContext *localContext) &#123;</span><br><span class="line">    <span class="comment">//在这里做存储工作，该闭包代码块的工作将会在后台线程运行</span></span><br><span class="line">&#125; completion:^(BOOL success, NSError *error) &#123;</span><br><span class="line">    [application endBackgroundTask:bgTask];</span><br><span class="line">    bgTask = UIBackgroundTaskInvalid;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p>
<p>2.<strong>将存储任务拆分成细小的存储</strong></p>
<p>类似导入大量数据这样的任务应该被拆分成多个小模块。一次性存储多少量的数据并没有统一的标准，所以你需要使用 Apple’s Instruments 的来测试下你的应用的性能。</p>
<h1 id="处理长时存储"><i class="icon-save"> 处理长时存储</i></h1><h2 id="ios平台"><i class="icon-mobile-phone"> ios平台</i></h2><p>当退出 ios 应用时，有机会来整理和存储数据到磁盘上。如果你知道存储操作要持续一会，那么最好的方法就是请求应用延期退出。如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">UIApplication *application = [UIApplication sharedApplication];</span><br><span class="line"></span><br><span class="line">__block UIBackgroundTaskIdentifier bgTask = [application beginBackgroundTaskWithExpirationHandler:^&#123;</span><br><span class="line">    [application endBackgroundTask:bgTask];</span><br><span class="line">    bgTask = UIBackgroundTaskInvalid;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[MagicalRecord saveWithBlock:^(NSManagedObjectContext *localContext) &#123;</span><br><span class="line">    <span class="comment">//这里做存储操作</span></span><br><span class="line">&#125; completion:^(BOOL success, NSError *error) &#123;</span><br><span class="line">    [application endBackgroundTask:bgTask];</span><br><span class="line">    bgTask = UIBackgroundTaskInvalid;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p>
<p>请确保认真阅读了 <a href="https://developer.apple.com/library/iOS/documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/UIApplication/beginBackgroundTaskWithExpirationHandler:" target="_blank" rel="external">read the documentation for beginBackgroundTaskWithExpirationHandler</a>，因为不适当或者不必要的延长应用程序的生命周期可能会在审核的时候遭到拒绝。</p>
<h2 id="OSX平台"><i class="icon-desktop"> OSX平台</i></h2><p>在 OS X Mavericks (10.9) 以及后面的版本中，App Nap 可以使得应用在后台的时候可以有效的被终止退出。如果你知道存储操作要持续一会，那么最好的方法就是暂时禁用自动终止和突然终止功能（前提是你的应用支持这些功能）：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">NSProcessInfo *processInfo = [NSProcessInfo processInfo];</span><br><span class="line"></span><br><span class="line">[processInfo disableSuddenTermination];</span><br><span class="line">[processInfo disableAutomaticTermination:@<span class="string">"Application is currently saving to persistent store"</span>];</span><br><span class="line"></span><br><span class="line">[MagicalRecord saveWithBlock:^(NSManagedObjectContext *localContext) &#123;</span><br><span class="line">    <span class="comment">//这里做存储操作</span></span><br><span class="line">&#125; completion:^(BOOL success, NSError *error) &#123;</span><br><span class="line">    [processInfo enableSuddenTermination];</span><br><span class="line">    [processInfo enableAutomaticTermination:@<span class="string">"Application has finished saving to the persistent store"</span>];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p>
<p>和 ios 实现一样，在实现之前确保阅读 <a href="https://developer.apple.com/library/mac/documentation/cocoa/reference/foundation/Classes/NSProcessInfo_Class/Reference/Reference.html" target="_blank" rel="external">read the documentation on NSProcessInfo</a>来避免被拒绝。</p>
<h1 id="变化"><i class="icon-bell-alt"> 变化</i></h1><p>在 MagicalRecord 2.2 中，存储API更加一致并遵循CoreData的命名模式。在这个版本中，已经加入了自动化测试来确保将来更新时，存储工作（新的API和废弃的API）能够继续工作。</p>
<p><code>MR_save</code>被暂时恢复到当前线程的同步运行和存储到<em>持久存储</em>(persistent store)的原始状态。然而，<strong><code>MR_save</code>方法被标记为“将被废弃”(deprecated)，将会在下个大版本 MagicalRecord 3.0 中移除掉。</strong>你应该使用<code>MR_saveToPersistentStoreAndWait</code>同功能函数来替代它。</p>
<h2 id="a)新的方法">a)新的方法</h2><p>新增加了下面几个方法：</p>
<h3 id="NSManagedObjectContext+MagicalSaves">NSManagedObjectContext+MagicalSaves</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) MR_saveOnlySelfWithCompletion:(MRSaveCompletionHandler)completion;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveToPersistentStoreWithCompletion:(MRSaveCompletionHandler)completion;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveOnlySelfAndWait;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveToPersistentStoreAndWait;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveWithOptions:(MRSaveContextOptions)mask completion:(MRSaveCompletionHandler)completion;</span><br></pre></td></tr></table></figure>
<h3 id="MagicalRecord+Actions">MagicalRecord+Actions</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>) saveWithBlock:(<span class="keyword">void</span>(^)(NSManagedObjectContext *localContext))block;</span><br><span class="line">+ (<span class="keyword">void</span>) saveWithBlock:(<span class="keyword">void</span>(^)(NSManagedObjectContext *localContext))block completion:(MRSaveCompletionHandler)completion;</span><br><span class="line">+ (<span class="keyword">void</span>) saveWithBlockAndWait:(<span class="keyword">void</span>(^)(NSManagedObjectContext *localContext))block;</span><br><span class="line">+ (<span class="keyword">void</span>) saveUsingCurrentThreadContextWithBlock:(<span class="keyword">void</span> (^)(NSManagedObjectContext *localContext))block completion:(MRSaveCompletionHandler)completion;</span><br><span class="line">+ (<span class="keyword">void</span>) saveUsingCurrentThreadContextWithBlockAndWait:(<span class="keyword">void</span> (^)(NSManagedObjectContext *localContext))block;</span><br></pre></td></tr></table></figure>
<h2 id="b)标记为废弃的函数">b)标记为废弃的函数</h2><p>下面这些函数被标记为“废弃的”，将会在 MagicalRecord 3.0 版本移除掉，推荐使用替代的函数。</p>
<h3 id="NSManagedObjectContext+MagicalSaves-1">NSManagedObjectContext+MagicalSaves</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) MR_save;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveWithErrorCallback:(<span class="keyword">void</span>(^)(NSError *error))errorCallback;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveInBackgroundCompletion:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))completion;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveInBackgroundErrorHandler:(<span class="keyword">void</span> (^)(NSError *error))errorCallback;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveInBackgroundErrorHandler:(<span class="keyword">void</span> (^)(NSError *error))errorCallback completion:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))completion;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveNestedContexts;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveNestedContextsErrorHandler:(<span class="keyword">void</span> (^)(NSError *error))errorCallback;</span><br><span class="line">- (<span class="keyword">void</span>) MR_saveNestedContextsErrorHandler:(<span class="keyword">void</span> (^)(NSError *error))errorCallback completion:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))completion;</span><br></pre></td></tr></table></figure>
<h3 id="MagicalRecord+Actions-1">MagicalRecord+Actions</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>) saveWithBlock:(<span class="keyword">void</span>(^)(NSManagedObjectContext *localContext))block;</span><br><span class="line">+ (<span class="keyword">void</span>) saveInBackgroundWithBlock:(<span class="keyword">void</span>(^)(NSManagedObjectContext *localContext))block;</span><br><span class="line">+ (<span class="keyword">void</span>) saveInBackgroundWithBlock:(<span class="keyword">void</span>(^)(NSManagedObjectContext *localContext))block completion:(<span class="keyword">void</span>(^)(<span class="keyword">void</span>))completion;</span><br><span class="line">+ (<span class="keyword">void</span>) saveInBackgroundUsingCurrentContextWithBlock:(<span class="keyword">void</span> (^)(NSManagedObjectContext *localContext))block completion:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))completion errorHandler:(<span class="keyword">void</span> (^)(NSError *error))errorHandler;</span><br></pre></td></tr></table></figure>
      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ios/">ios</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocoapods/">Cocoapods</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CoreData/">CoreData</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MagicalRecord/">MagicalRecord</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-easy-magicalrecord-03" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/07/21/easy-magicalrecord-03/" class="article-date">
  	<time datetime="2014-07-21T00:26:00.000Z" itemprop="datePublished">7月 21 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/21/easy-magicalrecord-03/">深入浅出MagicalRecord-03</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>我们接着上一篇 <a href="http://childhood.logdown.com/posts/209933/easy-magicalrecord-02" target="_blank" rel="external">深入浅出MagicalRecord-02</a>。</p>
<p>这节我们来一起学习下MagicalRecord对数据的<em>增删改查</em>，内容主要来自于 <a href="https://github.com/magicalpanda/MagicalRecord/blob/develop/Docs/Fetching.md" target="_blank" rel="external">MagicalRecord的github资料</a>。</p>
<h1 id="1-_增-创建实体">1. 增-创建实体</h1><figure class="highlight js"><figcaption><span>创建实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person *myPerson = [Person MR_createEntity];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>指定创建的上下文中创建实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person *myPerson = [Person MR_createInContext:otherContext];</span><br></pre></td></tr></table></figure>
<h1 id="2-_删-删除实体">2. 删-删除实体</h1><figure class="highlight js"><figcaption><span>删除一个实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[myPerson MR_deleteEntity];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>删除特定上下文中的实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[myPerson MR_deleteInContext:otherContext];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>删除所有实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Person MR_truncateAll];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>删除特定上下文中的所有实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Person MR_truncateAllInContext:otherContext];</span><br></pre></td></tr></table></figure>
<h1 id="3-_改-修改实体">3. 改-修改实体</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Person *person = ...;</span><br><span class="line">person.lastname = <span class="string">"xxx"</span>;</span><br></pre></td></tr></table></figure>
<h1 id="4-_查-查询实体">4. 查-查询实体</h1><p>查询的结果通常会返回一个<code>NSArray</code>结果。</p>
<h2 id="a)_基本查询">a) 基本查询</h2><figure class="highlight js"><figcaption><span>从持久化存储（PersistantStore）中查询出所有的Person实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSArray *people = [Person MR_findAll];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>查询出所有的Person实体并按照 lastName 升序（ascending）排列</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSArray *peopleSorted = [Person MR_findAllSortedBy:@<span class="string">"lastName"</span> ascending:YES];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>查询出所有的Person实体并按照 lastName 和 firstName 升序（ascending）排列</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSArray *peopleSorted = [Person MR_findAllSortedBy:@<span class="string">"lastName,firstName"</span> ascending:YES];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>查询出所有的Person实体并按照 lastName 降序，firstName 升序（ascending）排列</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NSArray *peopleSorted = [Person MR_findAllSortedBy:@<span class="string">"lastName:NO,firstName"</span> ascending:YES];</span><br><span class="line"><span class="comment">//或者</span></span><br><span class="line">NSArray *peopleSorted = [Person MR_findAllSortedBy:@<span class="string">"lastName,firstName:YES"</span> ascending:NO];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>查询出所有的Person实体 firstName 为 Forrest 的实体</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person *person = [Person MR_findFirstByAttribute:@<span class="string">"firstName"</span> withValue:@<span class="string">"Forrest"</span>];</span><br></pre></td></tr></table></figure>
<h2 id="b)_高级查询">b) 高级查询</h2><p>使用<code>NSPredicate</code>来实现高级查询。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSPredicate *peopleFilter = [NSPredicate predicateWithFormat:@<span class="string">"department IN %@"</span>, @[dept1, dept2]];</span><br><span class="line">NSArray *people = [Person MR_findAllWithPredicate:peopleFilter];</span><br></pre></td></tr></table></figure></p>
<h2 id="c)返回_NSFetchRequest">c)返回 NSFetchRequest</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSPredicate *peopleFilter = [NSPredicate predicateWithFormat:@<span class="string">"department IN %@"</span>, departments];</span><br><span class="line">NSFetchRequest *people = [Person MR_requestAllWithPredicate:peopleFilter];</span><br></pre></td></tr></table></figure>
<h2 id="d)自定义_NSFetchRequest">d)自定义 NSFetchRequest</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NSPredicate *peopleFilter = [NSPredicate predicateWithFormat:@<span class="string">"department IN %@"</span>, departments];</span><br><span class="line"></span><br><span class="line">NSFetchRequest *peopleRequest = [Person MR_requestAllWithPredicate:peopleFilter];</span><br><span class="line">[peopleRequest setReturnsDistinctResults:NO];</span><br><span class="line">[peopleRequest setReturnPropertiesNamed:@[@<span class="string">"firstName"</span>, @<span class="string">"lastName"</span>]];</span><br><span class="line"></span><br><span class="line">NSArray *people = [Person MR_executeFetchRequest:peopleRequest];</span><br></pre></td></tr></table></figure>
<h2 id="e)查询实体的个数">e)查询实体的个数</h2><figure class="highlight js"><figcaption><span>返回的是 NSNumber 类型</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSNumber *count = [Person MR_numberOfEntities];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>基于NSPredicate查询条件过滤后的实体个数</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSNumber *count = [Person MR_numberOfEntitiesWithPredicate:...];</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>返回的是 NSUInteger 类型</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+ (NSUInteger) MR_countOfEntities;</span><br><span class="line">+ (NSUInteger) MR_countOfEntitiesWithContext:(NSManagedObjectContext *)context;</span><br><span class="line">+ (NSUInteger) MR_countOfEntitiesWithPredicate:(NSPredicate *)searchFilter;</span><br><span class="line">+ (NSUInteger) MR_countOfEntitiesWithPredicate:(NSPredicate *)searchFilter inContext:(NSManagedObjectContext *)</span><br></pre></td></tr></table></figure>
<h2 id="f)合计操作">f)合计操作</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NSInteger totalFat = [[CTFoodDiaryEntry MR_aggregateOperation:@<span class="string">"sum:"</span> onAttribute:@<span class="string">"fatCalories"</span> withPredicate:predicate] integerValue];</span><br><span class="line"></span><br><span class="line">NSInteger fattest  = [[CTFoodDiaryEntry MR_aggregateOperation:@<span class="string">"max:"</span> onAttribute:@<span class="string">"fatCalories"</span> withPredicate:predicate] integerValue];</span><br><span class="line"></span><br><span class="line">NSArray *caloriesByMonth = [CTFoodDiaryEntry MR_aggregateOperation:@<span class="string">"sum:"</span> onAttribute:@<span class="string">"fatCalories"</span> withPredicate:predicate groupBy:@<span class="string">"month"</span>];</span><br></pre></td></tr></table></figure>
<h2 id="g)从指定上下文中查询">g)从指定上下文中查询</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NSArray *peopleFromAnotherContext = [Person MR_findAllInContext:someOtherContext];</span><br><span class="line"></span><br><span class="line">Person *personFromContext = [Person MR_findFirstByAttribute:@<span class="string">"lastName"</span> withValue:@<span class="string">"Gump"</span> inContext:someOtherContext];</span><br><span class="line"></span><br><span class="line">NSUInteger count = [Person MR_numberOfEntitiesWithContext:someOtherContext];</span><br></pre></td></tr></table></figure>
<center>下一篇：<a href="http://childhood.logdown.com/posts/211076/easy-magicalrecord-04" target="_blank" rel="external">深入浅出MagicalRecord-04</a></center>
      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ios/">ios</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocoapods/">Cocoapods</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CoreData/">CoreData</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MagicalRecord/">MagicalRecord</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/archives/2014/page/2/">2</a><a class="page-number" href="/archives/2014/page/3/">3</a><a class="page-number" href="/archives/2014/page/4/">4</a><a class="extend next" rel="next" href="/archives/2014/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2015 ChildhoodAndy
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style='display:none'>
        <span id="site-visit" >本站到访数: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style='display:none'>
        <span id="page-visit">, 本页阅读量: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: false,
		isArchive: true,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script type="text/javascript">
  var backgroundList = ["url(/background/bg-1.jpg)", "url(/background/bg-2.jpg)","url(/background/bg-3.jpg)","url(/background/bg-4.jpg)","url(/background/bg-5.jpg)"];
  var background = Math.floor(Math.random() * backgroundList.length);
  $("body").css({"background": backgroundList[background], "background-attachment": "fixed", "background-size": "cover"});
</script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<button class="hide-labels">TAG 开关</button>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js">
</script>
<script>
$(document).ready(function(){
  $("button").click(function(){
    $(".article-info").toggle(200);
  });
});
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>